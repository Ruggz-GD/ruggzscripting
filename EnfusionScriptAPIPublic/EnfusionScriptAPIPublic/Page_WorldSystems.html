<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Enfusion Script API: World Systems</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Enfusion Script API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">World Systems</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#WorldSystemsDocs_Introduction">Introduction</a></li>
<li class="level1"><a href="#WorldSystemDocs_CreatingAndUsingWorldSystem">Creating and using world system</a></li>
<li class="level1"><a href="#WorldSystemDocs_Info">World system information</a></li>
<li class="level1"><a href="#WorldSystemDocs_SystemPoints">System points</a></li>
<li class="level1"><a href="#WorldSystemDocs_SystemConfiguration">World system configuration</a></li>
<li class="level1"><a href="#WorldSystemDocs_ClassHierarchySupport">Support for class hierarchies</a></li>
<li class="level1"><a href="#WorldSystemDocs_Replication">Replication of world systems</a><ul><li class="level2"><a href="#WorldSystemDocs_SystemLocation">System location</a></li>
<li class="level2"><a href="#WorldSystemDocs_WorldController">World controllers</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="WorldSystemsDocs_Introduction"></a>
Introduction</h1>
<p>World systems are means to perform some operations at various stages of world update loop. They are meant to complement entities and their components. Usually world system implements some feature using entities and components in the world, similar to how a puppeteer would use puppets to perform a stage play.</p>
<p>World systems differ from entities and components in a few ways:</p><ul>
<li>Only one instance of particular world system type can be created for particular world. On the other hand, there can be many instances of single entity type in a world, and each entity instance may have possibly multiple components of same type on it.</li>
<li>Entities can be organized into hierarchies and have position and orientation in the world. World systems do not - while they are tied to the world, they do not exist on specific location inside of it.</li>
<li>Entities are updated one after another, and order in which their updates happen, is not defined. World systems can affect their order of updates through dependencies between them.</li>
<li>World file holds all entities and components which will be created in the world when it is loading (though more entities may be created after gameplay starts). What world systems will be instantiated is specified using a config file that is independent of the world.</li>
</ul>
<p>To demonstrate how world systems and entities with components would be used to build gameplay, let's use a simple FPS game where players spawn on spawn points placed in map. Game supports both deathmatch and team-deathmatch modes. Spawn points are represented as entities in the world. They are also assigned to specific teams either through property on entity itself, or on a component attached to entity that is dedicated to holding team affiliation information. We would then implement logic for score counting and player spawning for our two game modes using world systems. By switching configuration of these systems, we can run the map in deathmatch or team-deathmatch mode. If we are running in deathmatch mode, we can use all spawn points when determining where a player should spawn. If we are running in team-deathmatch mode, our respawn logic will be also taking into account team affiliation of each spawn point, ensuring players do not respawn in the middle of enemy territory.</p>
<p>Previous description has been intentionally very simple and vague. Goal was to give a rough idea of how things fit together without going into too many details. In a real game, there may be many more systems driving a world (tens to even hundreds), many of which may be shared across all game modes, while others would be specific to particular game mode. Mods may also alter behavior of systems, implement their own and organize them to create new game modes.</p>
<h1><a class="anchor" id="WorldSystemDocs_CreatingAndUsingWorldSystem"></a>
Creating and using world system</h1>
<p>Let us take a look at how a world system is implemented and integrated in the game.</p>
<p>There are a few things necessary for every world system to work:</p><ol type="1">
<li>Your world system class must be derived from <a class="el" href="interfaceBaseSystem.html" title="To create a system, you just need to create a class which inherits from BaseSystem,...">BaseSystem</a> or one of its subclasses.</li>
<li>You need to override <a class="el" href="interfaceBaseSystem.html#aacfc1c846d6d9599957355fbe2a5978b">BaseSystem.InitInfo()</a>.</li>
<li>In your implementation of <code>InitInfo()</code> function, you set information about your world system so that engine knows how to handle it.</li>
</ol>
<dl class="section remark"><dt>Remarks</dt><dd>Arma Reforger currently uses a legacy version of world systems. This document will refer to these as "legacy systems". Differences between current and legacy systems will be described as they come up. Unfortunately, not every feature is supported by legacy systems using current version on Arma Reforger is not possible yet.</dd></dl>
<p>Following code is an example of very simple world system, with each of the above points marked. </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfaceHelloWorldSystem.html">HelloWorldSystem</a> : <a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a> <span class="comment">// 1.</span></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceHelloWorldSystem.html#a95f33f6d31fed742b6e75f08116c51ee">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo) <span class="comment">// 2.</span></div>
<div class="line">    {</div>
<div class="line">        outInfo.<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">false</span>); <span class="comment">// 3.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceHelloWorldSystem.html#a90315e44a4a8c5f4d71b0e551160b633">HelloWorldSystem</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;Hello world (systems)&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>After we recompile and reload scripts in workbench, we are done defining our world system in script. But we won't be able to see it in game just yet. For that, we need to run the game with config that references our world system, so we either have to create new config, or add it to an existing one. In practice, you will most likely be adding your world system to existing config, but to demonstrate all steps of the process, we will be creating new config from scratch.</p>
<p>To create new world system config:</p><ol type="1">
<li>In "Resource Browser", select directory where you want to place your config, right-click in an empty space and choose "Config file" in "Create Resource" section of the context menu.</li>
<li>Type name of your config file.</li>
<li>Choose "SystemSettings" as config class.</li>
</ol>
<p><img src="create-config-file.png" alt="" class="inline"/> <img src="create-config-file-name.png" alt="" class="inline"/> <img src="create-config-file-class.png" alt="" class="inline"/> <img src="create-config-file-done.png" alt="" class="inline"/></p>
<p>You should now see your new config file in "Resource Browser". From here on, the process is the same same as adding to an existing config:</p><ol type="1">
<li>Double-click on the config file in "Resource Browser" to open it.</li>
<li>Add new entry to "Systems" array using "+" button.</li>
<li>Search for your new world system type, then select it by clicking on it.</li>
</ol>
<p><img src="add-world-system-open-config.png" alt="" class="inline"/> <img src="add-world-system-search.png" alt="" class="inline"/> <img src="add-world-system-done.png" alt="" class="inline"/></p>
<p>You should now have your world system added to the end of the "Systems" array. When this config is used to run a world, world systems listed in the "Systems" array will be created.</p>
<p>Steps for running world with particular config are specific to each game so we won't go into that here. However, for testing, "World Editor" supports selecting one of predefined configs to use in "Play Mode". For our config to appear in this list, we need to add it there first:</p><ol type="1">
<li>In main workbench window menu at the top, go to "Workbench", then "Options".</li>
<li>In "Game Project" tab, in bottom part scroll down to "Modules" section, looking for "System Module Settings".</li>
<li>Add your config to the "Configs" array.</li>
</ol>
<p><img src="testing-options.png" alt="" class="inline"/> <img src="testing-module-settings.png" alt="" class="inline"/> <img src="testing-play-mode-menu.png" alt="" class="inline"/></p>
<p>If you now open some world in World Editor, you can go to "Play Mode" button dropdown menu, "World Systems Config" submenu, and see your config there. Clicking it will select it for use when entering "Play Mode". With your config selected, if you now enter play mode, you should see the message from <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> constructor appear in log. This shows us that our world system has been created and everything works as expected.</p>
<p>World systems can be queried at runtime as well. To try it out, you can paste following code into Remote Console of Script Editor while you are in play mode with <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> created (note that this script relies on <code>GetGame()</code> function, which might not be available in all projects). </p><div class="fragment"><div class="line"><span class="comment">// Make sure you are using correct world, as there may be multiple worlds in</span></div>
<div class="line"><span class="comment">// some situations and main game world is not always the one you want.</span></div>
<div class="line"><a class="code hl_interface" href="interfaceWorld.html">World</a> world = GetGame().GetWorld();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Once you have the world, you query it for particular system.</span></div>
<div class="line"><a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a> foundSystem = world.<a class="code hl_function" href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c">FindSystem</a>(<a class="code hl_interface" href="interfaceHelloWorldSystem.html">HelloWorldSystem</a>);</div>
<div class="line"><a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(foundSystem);</div>
<div class="ttc" id="agroup__Debug_html_ga4080cd5485010d254548bb55ecc5522a"><div class="ttname"><a href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a></div><div class="ttdeci">proto void Print(void var, LogLevel level=LogLevel.NORMAL)</div><div class="ttdoc">Prints content of variable to console/log.</div></div>
<div class="ttc" id="ainterfaceBaseSystem_html"><div class="ttname"><a href="interfaceBaseSystem.html">BaseSystem</a></div><div class="ttdoc">To create a system, you just need to create a class which inherits from BaseSystem,...</div><div class="ttdef"><b>Definition</b> BaseSystem.c:16</div></div>
<div class="ttc" id="ainterfaceHelloWorldSystem_html"><div class="ttname"><a href="interfaceHelloWorldSystem.html">HelloWorldSystem</a></div><div class="ttdoc">[Hello world system]</div><div class="ttdef"><b>Definition</b> WorldSystemsDocs.c:542</div></div>
<div class="ttc" id="ainterfaceWorld_html"><div class="ttname"><a href="interfaceWorld.html">World</a></div><div class="ttdoc">derived class connected to gamelib to implement game related features</div><div class="ttdef"><b>Definition</b> World.c:16</div></div>
<div class="ttc" id="ainterfaceWorld_html_a5c198b6411cf43df46ab150315d0101c"><div class="ttname"><a href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c">World.FindSystem</a></div><div class="ttdeci">proto external BaseSystem FindSystem(TypeName type)</div><div class="ttdoc">Find a system from his type.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="WorldSystemDocs_Info"></a>
World system information</h1>
<p>Let us now go back to the <a class="el" href="interfaceHelloWorldSystem.html#a95f33f6d31fed742b6e75f08116c51ee">HelloWorldSystem.InitInfo()</a> function we implemented in our example. This function has only one purpose: to fill <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> instance with information about our system. Each world system has some meta-information associated with it, which is stored in <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>. Engine uses this information for various purposes: ordering of updates, dependencies between world systems, determining whether instance of world system should be created in some situation, and so on. We will be going over various <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> properties in related sections.</p>
<p>Main reason for this approach is to allow derived classes and mods to inherit as much of the information from the original system, making changes to only those properties they need to. Here is an example of how someone might decide to mod our <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> in order to introduce per-frame updates to it: </p><div class="fragment"><div class="line">modded <span class="keyword">class </span><a class="code hl_interface" href="interfaceHelloWorldSystem.html">HelloWorldSystem</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceHelloWorldSystem.html#a95f33f6d31fed742b6e75f08116c51ee">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        super.<a class="code hl_function" href="interfaceHelloWorldSystem.html#a95f33f6d31fed742b6e75f08116c51ee">InitInfo</a>(outInfo); <span class="comment">// 1.</span></div>
<div class="line">        outInfo.<a class="code hl_function" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">AddPoint</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame); <span class="comment">// 2.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">int</span> m_FrameCount = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceHelloWorldSystem.html#a6c5ad180b8ce7f46811716d95986ace1">OnUpdate</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a> point)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (point == <a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> frameIndex = m_FrameCount;</div>
<div class="line">            <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;Hello world (systems) frame %1&quot;</span>, frameIndex);</div>
<div class="line"> </div>
<div class="line">            m_FrameCount += 1;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// Stop when we&#39;ve done 10 frame updates (printed frame numbers from 0 to 9).</span></div>
<div class="line">            <span class="keywordflow">if</span> (m_FrameCount == 10)</div>
<div class="line">                this.<a class="code hl_function" href="interfaceBaseSystem.html#a0ff873b28331fffe7347373de4cb8453">Enable</a>(<span class="keyword">false</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Important bits are:</p><ol type="1">
<li>Calling InitInfo() implementation of base class (or class being modded), letting it do its thing.</li>
<li>Making changes necessary for our implementation.</li>
</ol>
<p>Default values of <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> properties are well defined, but you might not always be able to rely on them. Specifically, all world systems implemented in native code get to modify these default values in <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> before <code>InitInfo()</code> is called. The only system that guarantees to leave default values unchanged is <a class="el" href="interfaceBaseSystem.html" title="To create a system, you just need to create a class which inherits from BaseSystem,...">BaseSystem</a>. If it is necessary to ensure that <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> has everything set to default, one can use <a class="el" href="interfaceWorldSystemInfo.html#ac4dd52e6a87422d07f67592b457fb4f1" title="Restore all properties to their default values.">WorldSystemInfo.RestoreDefaults()</a> to achieve it.</p>
<dl class="section warning"><dt>Warning</dt><dd>Using <a class="el" href="interfaceWorldSystemInfo.html#ac4dd52e6a87422d07f67592b457fb4f1" title="Restore all properties to their default values.">WorldSystemInfo.RestoreDefaults()</a> should be considered last resort. In almost all cases, it is better to use more fine-grained operations, otherwise you risk maintenance issues further down the line.</dd></dl>
<p>With the exception of <a class="el" href="interfaceWorldSystemInfo.html#ac4dd52e6a87422d07f67592b457fb4f1" title="Restore all properties to their default values.">WorldSystemInfo.RestoreDefaults()</a>, all <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> functions follow same naming convention, which puts together operation and property on which this operation happens. Based on operations available, there are two kinds of properties:</p><ol type="1">
<li>Single-value properties, which only provide <code>Set*()</code> operation.<ul>
<li><a class="el" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">WorldSystemInfo.SetAbstract()</a></li>
</ul>
</li>
<li>Set-like properties, which provide <code>Add*()</code>, <code>Remove*()</code> and <code>Clear*()</code> operations.<ul>
<li><a class="el" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">WorldSystemInfo.AddPoint()</a></li>
<li><a class="el" href="interfaceWorldSystemInfo.html#ac5218ab75407812d21ad3301e179b75f">WorldSystemInfo.RemovePoint()</a></li>
<li><a class="el" href="interfaceWorldSystemInfo.html#a17a40b43b644a8b8be87c140c8a329e0">WorldSystemInfo.ClearPoints()</a></li>
</ul>
</li>
</ol>
<dl class="section warning"><dt>Warning</dt><dd>While <code>InitInfo()</code> function allows one to write anything they want, in most cases the implementation should be very simple. For this reason, there is no support for querying property values. Highly suspicious things include (but are not limited to):<ul>
<li>any kind of control flow (branches, loops)</li>
<li>function calls other than <code>super.InitInfo()</code> or <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> member functions</li>
<li>side-effects other than changes in <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a></li>
<li>reliance on any kind of state of classes or variables (including global or static variables)</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="WorldSystemDocs_SystemPoints"></a>
System points</h1>
<p>Every world system can register for updates at particular points in world update loop. We have already seen how this is done in previous example, so let's look at it again: </p><div class="fragment"><div class="line"><span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceHelloWorldSystem.html#a95f33f6d31fed742b6e75f08116c51ee">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">{</div>
<div class="line">    super.<a class="code hl_function" href="interfaceHelloWorldSystem.html#a95f33f6d31fed742b6e75f08116c51ee">InitInfo</a>(outInfo); <span class="comment">// 1.</span></div>
<div class="line">    outInfo.<a class="code hl_function" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">AddPoint</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame); <span class="comment">// 2.</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>Legacy system specifies system points using config property "System Points" which can be modified in world system config.</dd></dl>
<p>When we initialize <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>, we call <a class="el" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">WorldSystemInfo.AddPoint()</a>, passing <a class="el" href="group__WorldSystems.html#ggab62a728d184791388d51668aa8614da7a3bb3e8c8a24891ba0f7608bcc96f8b0a">ESystemPoint.Frame</a> as argument (marked by <code>2.</code> in the example). This tells engine that our world system wants to update during this system point. If a world system is registered for updates on at least one system point, its <code>OnUpdate()</code> function will be called whenever that system point is hit during world update loop.</p>
<p>There are several system points that world systems can register to. For a full list you can refer to <a class="el" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>. Many of them are related to entity events (see <a class="el" href="group__Entities.html#gaa29339063b04471895b3cb38b17cdb13">EntityEvent</a>) and thus follow similar rules. For example, every iteration of world update loop is guaranteed to hit <a class="el" href="group__WorldSystems.html#ggab62a728d184791388d51668aa8614da7a3bb3e8c8a24891ba0f7608bcc96f8b0a">ESystemPoint.Frame</a> (same as <a class="el" href="group__Entities.html#ggaa29339063b04471895b3cb38b17cdb13ac57e921596445b99ab85558984966184">EntityEvent.FRAME</a>) exactly once. On the other hand, <a class="el" href="group__WorldSystems.html#ggab62a728d184791388d51668aa8614da7aeb7627a29a1cd157686ad244fe8a3c50">ESystemPoint.FixedFrame</a> (same as <a class="el" href="group__Entities.html#ggaa29339063b04471895b3cb38b17cdb13acc70eb02206344b521c7c85f07d71efd">EntityEvent.FIXEDFRAME</a>) may be hit zero or more times, depending on how much time one iteration of world update loop took and what is the fixed timestep logic used by particular game.</p>
<p>It is also possibly to affect the relative ordering of world systems that registered to same system point. To do so, <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> has <code>ExecuteBefore</code> and <code>ExecuteAfter</code> properties that can be used to specify ordering constraints.</p>
<dl class="section warning"><dt>Warning</dt><dd>Unless two systems have execution constraint specified between them (either through <code>ExecuteBefore</code> on first, or through <code>ExecuteAfter</code> on second), their ordering is undefined. In practice, these two systems without execution constraint will execute in some order, and that order may appear to stay the same for some time, but there is no guarantee that it will stay the same forever.</dd></dl>
<p>Here is an example of a system that uses multiple system points and specifies execution constraint on our <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> from previous examples: </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfaceMultiPointSystem.html">MultiPointSystem</a> : <a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceMultiPointSystem.html#a60ce2e6011837e51203ffa202d380e04">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        outInfo</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">false</span>)</div>
<div class="line">            <span class="comment">// 1.</span></div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">AddPoint</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame)</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">AddPoint</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.FixedFrame)</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">AddPoint</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.SimulatePhysics)</div>
<div class="line">            <span class="comment">// 2.</span></div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a17ce349b348280a9a8a100056053775a">AddExecuteBefore</a>(<a class="code hl_interface" href="interfaceHelloWorldSystem.html">HelloWorldSystem</a>, <a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">int</span> m_FrameCount = 0;</div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">int</span> m_FixedFrameCount = 0;</div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">int</span> m_SimulatePhysicsCount = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceMultiPointSystem.html#a356fec00b1702a3b97343488363a87d6">OnUpdate</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a> point)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">switch</span> (point)</div>
<div class="line">        {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame:</div>
<div class="line">            <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;MultiPointSystem Frame %1&quot;</span>, m_FrameCount);</div>
<div class="line">            m_FrameCount += 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.FixedFrame:</div>
<div class="line">            <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;MultiPointSystem FixedFrame %1&quot;</span>, m_FixedFrameCount);</div>
<div class="line">            m_FixedFrameCount += 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.SimulatePhysics:</div>
<div class="line">            <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;MultiPointSystem SimulatePhysics %1&quot;</span>, m_SimulatePhysicsCount);</div>
<div class="line">            m_SimulatePhysicsCount += 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">int</span> total = m_FrameCount + m_FixedFrameCount + m_SimulatePhysicsCount;</div>
<div class="line">        <span class="keywordflow">if</span> (total &gt;= 100)</div>
<div class="line">            this.<a class="code hl_function" href="interfaceBaseSystem.html#a0ff873b28331fffe7347373de4cb8453">Enable</a>(<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>Legacy systems can provide virtual function <div class="fragment"><div class="line"><span class="keywordtype">bool</span> DependsOn(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a> point, <a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a> system)</div>
<div class="ttc" id="agroup__WorldSystems_html_gab62a728d184791388d51668aa8614da7"><div class="ttname"><a href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a></div><div class="ttdeci">ESystemPoint</div><div class="ttdef"><b>Definition</b> ESystemPoint.c:13</div></div>
</div><!-- fragment --> to describe dependencies. This is similar to <code>ExecuteAfter</code> in that when this function returns <code>true</code> for particular combination of point and system, it will be as if that combination of point and system was added to <code>ExecuteAfter</code> set. There is no <code>ExecuteBefore</code> equivalent available for legacy systems.</dd></dl>
<p>This system registers to three system points (<code>1.</code>). It also adds one execution constraint using <a class="el" href="interfaceWorldSystemInfo.html#a17ce349b348280a9a8a100056053775a">WorldSystemInfo.AddExecuteBefore()</a> (<code>2.</code>). This constraint says that in <a class="el" href="group__WorldSystems.html#ggab62a728d184791388d51668aa8614da7a3bb3e8c8a24891ba0f7608bcc96f8b0a">ESystemPoint.Frame</a>, <a class="el" href="interfaceMultiPointSystem.html#a356fec00b1702a3b97343488363a87d6" title="Called every time system is allowed to tick.">MultiPointSystem.OnUpdate()</a> must execute before <a class="el" href="interfaceHelloWorldSystem.html#a6c5ad180b8ce7f46811716d95986ace1" title="Called every time system is allowed to tick.">HelloWorldSystem.OnUpdate()</a>.</p>
<p>Rest of the code demonstrates different behavior of various system points. It counts how many times was particular system point hit and prints messages with system point and its hit index. After enough hits have been printed, system disables itself, preventing further calls to <code>OnUpdate()</code>.</p>
<p>Now add <a class="el" href="interfaceMultiPointSystem.html" title="[Hello world system - modded]">MultiPointSystem</a> to our previously created config that already contains <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> and run a world using this config. Based on order in which log messages from each system appear, you can see that <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> and <a class="el" href="interfaceMultiPointSystem.html" title="[Hello world system - modded]">MultiPointSystem</a> execute <a class="el" href="group__WorldSystems.html#ggab62a728d184791388d51668aa8614da7a3bb3e8c8a24891ba0f7608bcc96f8b0a">ESystemPoint.Frame</a> in order we specified. You can try to change constraint from <code>ExecuteBefore</code> to <code>ExecuteAfter</code> to see messages appear in the opposite order. Or you can remove execution constraint altogether and see in what order they execute afterwards (though don't rely on it to stay the same).</p>
<dl class="section note"><dt>Note</dt><dd>Instead of <code>ExecuteBefore</code> on <a class="el" href="interfaceMultiPointSystem.html" title="[Hello world system - modded]">MultiPointSystem</a>, we could have set <code>ExecuteAfter</code> on <a class="el" href="interfaceHelloWorldSystem.html" title="[Hello world system]">HelloWorldSystem</a> which would have the same effect (of course, changing what system is passed to it as well). In most cases it doesn't matter where constraint is specified, but good practice is to prefer specifying it in system that you are maintaining, instead of adding or modding it into someone else' system.</dd></dl>
<p>Very likely you will also notice that number of hits at the end is different for each system point we registered. This is because of different system points having different relation to world update loop. <a class="el" href="group__WorldSystems.html#ggab62a728d184791388d51668aa8614da7ae1ca57fbc54d30d3db87c5a4886f39f5">ESystemPoint.SimulatePhysics</a> might not appear at all if there are no objects that require simulation of physics. However, order in which these system points are hit (assuming they are hit at all) is guaranteed. Describing world update loop in detail is outside the scope of world systems, though.</p>
<h1><a class="anchor" id="WorldSystemDocs_SystemConfiguration"></a>
World system configuration</h1>
<p>World systems can declare variables that will be exposed in world system config. This is done by decorating variable declarations with <a class="el" href="interfaceAttribute.html">Attribute</a>. These variables will then be initialized by engine and world system can use them at runtime.</p>
<dl class="section warning"><dt>Warning</dt><dd>As of right now, config variables are initialized after constructor is executed. In other words, constructor will not see values from config file.</dd></dl>
<p>Here is an example of exposing variables in world system config: </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfaceConfigurableSystem.html">ConfigurableSystem</a> : <a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceConfigurableSystem.html#aefbfca5f7c55612bc2326a82a943e461">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        outInfo.<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    [<a class="code hl_interface" href="interfaceAttribute.html">Attribute</a>(defvalue: <span class="stringliteral">&quot;2&quot;</span>)] <span class="comment">// 2.</span></div>
<div class="line">    private <a class="code hl_interface" href="interfaceint.html">int</a> m_ConfigInt; <span class="comment">// 1.</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceConfigurableSystem.html#a8d393d5334f42600ba8b9165b9ac72dc">ConfigurableSystem</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;ConfigurableSystem.ctor m_ConfigInt = %1&quot;</span>, m_ConfigInt); <span class="comment">// 4.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceConfigurableSystem.html#af73c572bf879ae65b9c0caeb7606ba82">OnInit</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;ConfigurableSystem.OnInit m_ConfigInt = %1&quot;</span>, m_ConfigInt); <span class="comment">// 3.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><ol type="1">
<li>We declare member variable <code>m_ConfigInt</code> which will be initialized from config.</li>
<li>We decorate it using <a class="el" href="interfaceAttribute.html">Attribute</a> to let engine know that <code>m_ConfigInt</code> should be exposed through config, as well as how to expose it (in this case, what should be its default value).</li>
<li>We print value of <code>m_ConfigInt</code> we obtained from config.</li>
<li>We demonstrate that constructor can observe uninitialized value of <code>m_ConfigInt</code> by also printing it there.</li>
</ol>
<p>Running world with this world system will produce two messages in log. First will come from constructor of <a class="el" href="interfaceConfigurableSystem.html" title="[Multi-point system]">ConfigurableSystem</a>, showing value of <code>m_ConfigInt</code> is 0, second will come from <a class="el" href="interfaceConfigurableSystem.html#af73c572bf879ae65b9c0caeb7606ba82" title="Called when system are to be intialized.">ConfigurableSystem.OnInit()</a>, where value of <code>m_ConfigInt</code> will match whatever you set in the config (2 by default).</p>
<dl class="section note"><dt>Note</dt><dd>In general, a world system can also change its behavior based on entities present in the world. Whether some configuration option should come from world system config, or from an entity in the world, is sometimes not clear. Ideally, configuration in world system config should be independent from worlds themselves so that one config can be used with different worlds. Things which are specific to particular world should be stored in that world. However, there are also ambiguous situations which are hard to categorize. In those cases, one should consider pros and cons of either approach and decide accordingly. Sometimes, there just isn't a simple answer.</dd></dl>
<h1><a class="anchor" id="WorldSystemDocs_ClassHierarchySupport"></a>
Support for class hierarchies</h1>
<p>Let's say we want to model multiple game modes by having one common base class for them (derived from <a class="el" href="interfaceBaseSystem.html" title="To create a system, you just need to create a class which inherits from BaseSystem,...">BaseSystem</a>) which defines common interface of all game modes. For two game modes (using deathmatch and team-deathmatch example from <a class="el" href="#WorldSystemsDocs_Introduction">Introduction</a>) we would like to have following inheritance relationship:</p>
<div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_inline_dotgraph_10.svg" width="499" height="251"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<p>We would also like to enforce a few rules:</p><ol type="1">
<li>Only one game mode can be created at a time.</li>
<li>It shouldn't be possible to create <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> itself as it is just defining interface without implementation, only full implementations can be created.</li>
<li>Others can search for <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> type using <a class="el" href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c" title="Find a system from his type.">World.FindSystem()</a> and obtain created game mode.</li>
</ol>
<p>Enforcing rule 2 is the easiest and we have already seen it before in previous examples: <code>Abstract</code> property of <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>. Basically, abstract systems cannot be instantiated and they will not appear as option when editing world system config. All world systems derived from <a class="el" href="interfaceBaseSystem.html" title="To create a system, you just need to create a class which inherits from BaseSystem,...">BaseSystem</a> are abstract by default. In all of our previous examples, we were marking world systems as not abstract so we could add them to world system config. This time, we will do the opposite and mark <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> as abstract.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Legacy systems implemented in script are not abstract and they can always be instantiated. It is not possible to change this.</dd></dl>
<p>Rules 1 and 3 may seem unrelated at first, but we can solve them together. If you look at <a class="el" href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c" title="Find a system from his type.">World.FindSystem()</a> function, you will notice that it can return at most one world system instance for particular type. Behavior of <code>FindSystem(type)</code> can be summarized as follows: If <code>type</code> is <em>unique</em> (or derived from unique type), then it returns the one instance that can be safely cast to this type (or null if there is no such world system instance). For all other types, it only returns instances that match the type exactly, ignoring inheritance relationships. This brings us to <code>Unique</code> property of <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>. When a world system type is marked as unique using this property, only one world system that is derived from this unique type can be created at runtime. In other words, if we make <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> type unique, we will enforce that only one implementation of game mode will be created at runtime and also make <a class="el" href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c" title="Find a system from his type.">World.FindSystem()</a> allow searches for <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> type to return this game mode implementation.</p>
<p>Here is what it would all look like in the code. </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfaceGameMode.html">GameMode</a> : <a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceGameMode.html#aecda08fce0ed5a558d70bcd24f4664ad">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// 1.</span></div>
<div class="line">        outInfo</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">true</span>)</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a33f5e4592d3183d9c3ab7a26a6f3aa84">SetUnique</a>(<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2.</span></div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceGameMode.html#a9ca511b4755d3489983331d40608cb17">OnInit</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;GameMode.OnInit()&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3.</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceGameMode.html#acf861d01a57ac8c507421d93ed6995bc">Notify</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfaceDeathmatchMode.html">DeathmatchMode</a> : <a class="code hl_interface" href="interfaceGameMode.html">GameMode</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceDeathmatchMode.html#ab130d084d76ffc72e663513bb34cbe65">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// 1.</span></div>
<div class="line">        outInfo.<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2.</span></div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceDeathmatchMode.html#ae323fc4cf366d1fdcc023bb6b6e93719">OnInit</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;DeathmatchMode.OnInit()&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3.</span></div>
<div class="line">    <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceDeathmatchMode.html#a4e6535325fcd07c793742ced43d163cc">Notify</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;DeathmatchMode.Notify()&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfaceTeamDeathmatchMode.html">TeamDeathmatchMode</a> : <a class="code hl_interface" href="interfaceGameMode.html">GameMode</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceTeamDeathmatchMode.html#a5a3104d9ce8b09a3aaa2e092d4e043f1">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// 1.</span></div>
<div class="line">        outInfo.<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2.</span></div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceTeamDeathmatchMode.html#a9f1be9214f26eb254217f1017123b204">OnInit</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;TeamDeathmatchMode.OnInit()&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3.</span></div>
<div class="line">    <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfaceTeamDeathmatchMode.html#aacee4195e37aa9a7a8899d3bc1464e52">Notify</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;TeamDeathmatchMode.Notify()&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><ol type="1">
<li>We set <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> properties <code>Abstract</code> and <code>Unique</code> to <code>true</code>, preventing creation of <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> itself, and also requiring that at most one type derived from <a class="el" href="interfaceGameMode.html" title="[Configurable system]">GameMode</a> can be created. Actual game mode implementations have <code>Abstract</code> set to <code>false</code>.</li>
<li>We use <code><a class="el" href="group__Sound.html#ggaa2a40a2fbb3a9d1d4ed4ac8287ec85b2afb56fb9b26e7037590b59fc139f9ca3d">OnInit()</a></code> to see which game mode is created by printing messages specific to each game mode.</li>
<li>We also declare a <a class="el" href="interfaceGameMode.html#acf861d01a57ac8c507421d93ed6995bc">GameMode.Notify()</a> function that can be invoked by rest of the game without knowing which game mode is actually running.</li>
</ol>
<p>If you now run world with either <a class="el" href="interfaceDeathmatchMode.html">DeathmatchMode</a> or <a class="el" href="interfaceTeamDeathmatchMode.html">TeamDeathmatchMode</a>, you will see corresponding message from <code><a class="el" href="group__Sound.html#ggaa2a40a2fbb3a9d1d4ed4ac8287ec85b2afb56fb9b26e7037590b59fc139f9ca3d">OnInit()</a></code> in log. You can also test in Remote Console of Script Editor that <code>Notify()</code> can be called without knowing which game mode exactly is created: </p><div class="fragment"><div class="line"><a class="code hl_interface" href="interfaceWorld.html">World</a> world = GetGame().GetWorld();</div>
<div class="line"><a class="code hl_interface" href="interfaceGameMode.html">GameMode</a> gameMode = <a class="code hl_interface" href="interfaceGameMode.html">GameMode</a>.Cast(world.<a class="code hl_function" href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c">FindSystem</a>(<a class="code hl_interface" href="interfaceGameMode.html">GameMode</a>));</div>
<div class="line">gameMode.<a class="code hl_function" href="interfaceGameMode.html#acf861d01a57ac8c507421d93ed6995bc">Notify</a>();</div>
<div class="ttc" id="ainterfaceGameMode_html"><div class="ttname"><a href="interfaceGameMode.html">GameMode</a></div><div class="ttdoc">[Configurable system]</div><div class="ttdef"><b>Definition</b> WorldSystemsDocs.c:654</div></div>
<div class="ttc" id="ainterfaceGameMode_html_acf861d01a57ac8c507421d93ed6995bc"><div class="ttname"><a href="interfaceGameMode.html#acf861d01a57ac8c507421d93ed6995bc">GameMode.Notify</a></div><div class="ttdeci">void Notify()</div></div>
</div><!-- fragment --><dl class="section remark"><dt>Remarks</dt><dd>Legacy systems are marked as <em>unique</em> automatically based on their base class. If their direct base class is either <a class="el" href="interfaceBaseSystem.html" title="To create a system, you just need to create a class which inherits from BaseSystem,...">BaseSystem</a> or <code>GameSystem</code>, they are marked as unique. It is not possible to change this.</dd></dl>
<h1><a class="anchor" id="WorldSystemDocs_Replication"></a>
Replication of world systems</h1>
<dl class="section note"><dt>Note</dt><dd>This section requires some understanding of replication and replication-related terminology. If you can't understand something, feel free to ignore it. Things will make more sense once you get familiar with replication as well.</dd></dl>
<p>All world systems support replication and can work in multiplayer. It is up to author of the system to decide whether that is necessary or not. In some cases, a world system naturally only exists on client (eg. sound system) or only on server (eg. hit registration that does lag compensation). In other cases, a world system needs to be replicated between server and clients.</p>
<p>For a world system to be replicated, it must be registered in replication. This is done automatically when all following conditions are met:</p><ol type="1">
<li>It must exist on both server and clients (we'll get to that in <a class="el" href="#WorldSystemDocs_SystemLocation">System location</a> section).</li>
<li>It must have some replicated state, RPC, or replication callback. In other words, its replication layout must not be empty.</li>
</ol>
<p>All replicated world systems are owned by server. This means that replicated world systems can broadcast information to all clients, but they cannot communicate with specific client (neither sending, nor receiving). We'll talk about communication between specific client and server in section <a class="el" href="#WorldSystemDocs_WorldController">World controllers</a>.</p>
<h2><a class="anchor" id="WorldSystemDocs_SystemLocation"></a>
System location</h2>
<p>To limit world system creation to either server or client, we use <code>Location</code> property of <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>. <a class="el" href="interfaceWorldSystemInfo.html#a6a789f6e40a34132d85a0a325eb0e580">WorldSystemInfo.SetLocation()</a> takes <a class="el" href="group__WorldSystems.html#gade20c4a48889d4b85339ceef081573ce">ESystemLocation</a>, which has three possible values: <code>Both</code>, <code>Client</code> and <code>Server</code>. However, game can be running in various multiplayer modes, and mapping might not be obvious. Following table summarizes which multiplayer modes match which locations (yes - system is created, no - system is not created):</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Multiplayer mode   </th><th class="markdownTableHeadNone">Both   </th><th class="markdownTableHeadNone">Client   </th><th class="markdownTableHeadNone">Server    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Single-player   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">yes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Multiplayer client   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">no    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Multiplayer listen server   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">yes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Multiplayer dedicated server   </td><td class="markdownTableBodyNone">yes   </td><td class="markdownTableBodyNone">no   </td><td class="markdownTableBodyNone">yes   </td></tr>
</table>
<p>This table may look strange at first. After all, why is mode with "server" in its name sometimes creating systems with <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea577d7068826de925ea2aec01dbadf5e4">ESystemLocation.Client</a>? You might want to think of <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea577d7068826de925ea2aec01dbadf5e4">ESystemLocation.Client</a> as "place where player interacts with the
game" (providing inputs, getting audio-visual output). On the other hand, <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea9aa1b03934893d7134a660af4204f2a9">ESystemLocation.Server</a> is "place where full game simulation happens" (ie. the only place that knows about everything). In that sense, because there is no way to interact with dedicated server, it makes no sense for world system that should only appear on <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea577d7068826de925ea2aec01dbadf5e4">ESystemLocation.Client</a> to be there. On the other hand, a multiplayer client knows only what server told it and doesn't have full picture required for running simulation, so world system that only appears on <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea9aa1b03934893d7134a660af4204f2a9">ESystemLocation.Server</a> wouldn't be able to function there. Single-player and listen server (ie. player-hosted server) are basically the same in this regard - they allow player interaction and also know about everything. In fact, single-player is just listen server that doesn't allow clients to connect.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Legacy system specifies location using config property "System Location" which can be modified in world system config.</dd></dl>
<h2><a class="anchor" id="WorldSystemDocs_WorldController"></a>
World controllers</h2>
<p>As mentioned before, world systems are not able to communicate with specific clients. To achieve that, each world system can specify world controllers that should be created along with this system for each player.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Legacy world systems do not support world controllers.</dd></dl>
<p>While owner of replicated world system is always server, owner of world controller is always one of the players. This allows owner player to communicate with server through the world controller and it also allows server to send information only to particular player via their controller.</p>
<p>Let's now take a look at an example of a world controller.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfacePlayerNameInputSystem.html">PlayerNameInputSystem</a> : <a class="code hl_interface" href="interfaceBaseSystem.html">BaseSystem</a> <span class="comment">// 1.</span></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfacePlayerNameInputSystem.html#a31980367cbcc65a5cb1cba96682bfe38">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldSystemInfo.html">WorldSystemInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// 2.</span></div>
<div class="line">        outInfo</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a212c9bd8613e77121bb29c32dee1ac1b">SetAbstract</a>(<span class="keyword">false</span>)</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a6a789f6e40a34132d85a0a325eb0e580">SetLocation</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gade20c4a48889d4b85339ceef081573ce">ESystemLocation</a>.Client)</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a3dcfe562e57200b9079e6927217e97ac">AddPoint</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a>.Frame)</div>
<div class="line">            .<a class="code hl_function" href="interfaceWorldSystemInfo.html#a23bd078fa2404c751a4ca517e837cfff">AddController</a>(<a class="code hl_interface" href="interfacePlayerNameInputController.html">PlayerNameInputController</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">override</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfacePlayerNameInputSystem.html#a7401f8fa59c6b882d67fa50657002c77">OnUpdate</a>(<a class="code hl_enumeration" href="group__WorldSystems.html#gab62a728d184791388d51668aa8614da7">ESystemPoint</a> point)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">string</span> playerName;</div>
<div class="line">        <span class="keywordtype">bool</span> apply = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Display DbgUI window which allows player to change their name.</span></div>
<div class="line">        <a class="code hl_interface" href="interfaceDbgUI.html">DbgUI</a>.<a class="code hl_function" href="interfaceDbgUI.html#a82800fd26f52499d97c827ea2ef4e644">Begin</a>(<span class="stringliteral">&quot;Player name input&quot;</span>);</div>
<div class="line">        <a class="code hl_interface" href="interfaceDbgUI.html">DbgUI</a>.<a class="code hl_function" href="interfaceDbgUI.html#a1de4185ede9648687fef48fe9e8bc366">InputText</a>(<span class="stringliteral">&quot;name&quot;</span>, playerName);</div>
<div class="line">        apply = <a class="code hl_interface" href="interfaceDbgUI.html">DbgUI</a>.<a class="code hl_function" href="interfaceDbgUI.html#a3f5aca44a5a376152a600c71c6892bba">Button</a>(<span class="stringliteral">&quot;Apply&quot;</span>);</div>
<div class="line">        <a class="code hl_interface" href="interfaceDbgUI.html">DbgUI</a>.<a class="code hl_function" href="interfaceDbgUI.html#a42a5f35524975693a3cc95585040a242">End</a>();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (apply)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// 4.</span></div>
<div class="line">            <span class="keyword">auto</span> controller = <a class="code hl_interface" href="interfacePlayerNameInputController.html">PlayerNameInputController</a>.Cast(</div>
<div class="line">                <a class="code hl_interface" href="interfaceWorldController.html">WorldController</a>.<a class="code hl_function" href="interfaceWorldController.html#aa03fa80027897478dcd01beb4024f0b0">FindMyController</a>(<span class="keyword">this</span>.GetWorld(), <a class="code hl_interface" href="interfacePlayerNameInputController.html">PlayerNameInputController</a>)</div>
<div class="line">            );</div>
<div class="line">            controller.<a class="code hl_function" href="interfacePlayerNameInputController.html#ad51e2f2361d38ef04520a1f1d17779ad">RequestNameChange</a>(playerName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_interface" href="interfacePlayerNameInputController.html">PlayerNameInputController</a> : <a class="code hl_interface" href="interfaceWorldController.html">WorldController</a> <span class="comment">// 1.</span></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfacePlayerNameInputController.html#a2f2362ebd8e906381f9066c11d877653">InitInfo</a>(<a class="code hl_interface" href="interfaceWorldControllerInfo.html">WorldControllerInfo</a> outInfo)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// 3.</span></div>
<div class="line">        outInfo.<a class="code hl_function" href="interfaceWorldControllerInfo.html#ae37926906b5e002fdab8d6536758f52c">SetPublic</a>(<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    [<a class="code hl_interface" href="interfaceRplProp.html">RplProp</a>(onRplName: <span class="stringliteral">&quot;OnPlayerNameChanged&quot;</span>)]</div>
<div class="line">    <a class="code hl_interface" href="interfacestring.html">string</a> <a class="code hl_variable" href="interfacePlayerNameInputController.html#a5fcf1c4e726063478c9fae10a75180e2">m_PlayerName</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="interfacePlayerNameInputController.html#ad51e2f2361d38ef04520a1f1d17779ad">RequestNameChange</a>(<span class="keywordtype">string</span> newPlayerName)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="interfaceWorldController.html#ab24c165564d92e99f70327bb488661d0">Rpc</a>(Rpc_NameChange_S, newPlayerName);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    [<a class="code hl_interface" href="interfaceRplRpc.html">RplRpc</a>(<a class="code hl_enumeration" href="group__Replication.html#ga57116155a1911d20a0c50019116456bc">RplChannel</a>.Reliable, <a class="code hl_enumeration" href="group__Replication.html#ga45e90935ccb94bdc16b33a5142d2db58">RplRcver</a>.Server)]</div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">void</span> Rpc_NameChange_S(<span class="keywordtype">string</span> newPlayerName)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="interfacePlayerNameInputController.html#a5fcf1c4e726063478c9fae10a75180e2">m_PlayerName</a> == newPlayerName)</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_variable" href="interfacePlayerNameInputController.html#a5fcf1c4e726063478c9fae10a75180e2">m_PlayerName</a> = newPlayerName;</div>
<div class="line">        <a class="code hl_interface" href="interfaceReplication.html">Replication</a>.<a class="code hl_function" href="interfaceReplication.html#a5735f0d4b62383dbeab33c22a127abb4">BumpMe</a>();</div>
<div class="line">        <span class="comment">// We invoke callback explicitly on server. On clients, it will be invoked</span></div>
<div class="line">        <span class="comment">// automatically when replication changes m_PlayerName value.</span></div>
<div class="line">        this.OnPlayerNameChanged();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">void</span> OnPlayerNameChanged()</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">auto</span> serverSideOwner = this.<a class="code hl_function" href="interfaceWorldController.html#ac845e66e53cb276e27354ef74fada164">GetServerSideOwner</a>();</div>
<div class="line">        <span class="comment">// This message will appear on server and all clients.</span></div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#gafd115e9ad613543c644a80a4803dfda5">PrintFormat</a>(<span class="stringliteral">&quot;Player %1 name &#39;%2&#39;&quot;</span>, serverSideOwner, <a class="code hl_variable" href="interfacePlayerNameInputController.html#a5fcf1c4e726063478c9fae10a75180e2">m_PlayerName</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
</div><!-- fragment --><ol type="1">
<li>We declare our world system called <a class="el" href="interfacePlayerNameInputSystem.html" title="[Class hierarchy example]">PlayerNameInputSystem</a>, similar to other world systems we've seen before. We also declare <a class="el" href="interfacePlayerNameInputController.html" title="[World controller example]">PlayerNameInputController</a> which is derived from <a class="el" href="interfaceWorldController.html">WorldController</a>. This is how world controllers are declared.</li>
<li>We set up <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>. There are two interesting bits here:<ol type="a">
<li>We set <code>Location</code> to <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea577d7068826de925ea2aec01dbadf5e4">ESystemLocation.Client</a>. This system just provides means for player to provide us with some input (player name), so we don't need it on server.</li>
<li>We add <a class="el" href="interfacePlayerNameInputController.html" title="[World controller example]">PlayerNameInputController</a> to <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> property <code>Controllers</code>. This tells the engine which controllers to instantiate for a particular system.</li>
</ol>
</li>
<li>We set up <a class="el" href="interfaceWorldControllerInfo.html">WorldControllerInfo</a> for our controller. This is similar concept as <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a> - it gives the engine information about particular controller.</li>
<li>When "Apply" button is pressed, we look up <a class="el" href="interfacePlayerNameInputController.html" title="[World controller example]">PlayerNameInputController</a> instance belonging to player controlling the game and we request change of name through this controller. This request is sent to server where it can be handled.</li>
</ol>
<p>Step 3. brings up an aspect of controller which wasn't mentioned yet. We said that each controller is owned by particular player. As such, controllers are always streamed to their owners and so each client owning a controller has a proxy instance of it which it can search for (eg. using <a class="el" href="interfaceWorldController.html#aa03fa80027897478dcd01beb4024f0b0">WorldController.FindMyController()</a>). However, what about controllers belonging to other players? This is what <code>Public</code> property on <a class="el" href="interfaceWorldControllerInfo.html">WorldControllerInfo</a> affects. A public controller is one that appears on all clients, not just its owner. A private controller (ie. one that is not public) will only be present on client who owns it. However, server knows about all controllers (both public and private) and it doesn't matter if it is listen server (which owns one of these controllers) or dedicated server (which doesn't own any controller). So in our example, we take advantage of the fact that controller is public and we use that to communicate name of particular player to all other players.</p>
<p>You might also notice how in step 4. we search for controller using <a class="el" href="interfaceWorldController.html#aa03fa80027897478dcd01beb4024f0b0">WorldController.FindMyController()</a> function. This is similar to <a class="el" href="interfaceWorld.html#a5c198b6411cf43df46ab150315d0101c" title="Find a system from his type.">World.FindSystem()</a> which we've already seen before. To make inheritance work with this kind of API, <a class="el" href="interfaceWorldControllerInfo.html">WorldControllerInfo</a> also has <code>Unique</code> property, similar to <a class="el" href="interfaceWorldSystemInfo.html" title="Structure holding world system meta-information required by the engine.">WorldSystemInfo</a>. Behavior of unique controllers is similar to that of unique systems - only one world controller derived from unique world controller type can be instantiated.</p>
<p>It may be tempting to use controller constructor to react to controller creation (as a "player connected" event of sorts), but you should keep in mind that not everything might be fully set up at the time of constructor invocation. For this purpose, there are other functions on controller which may be better suited for this:</p>
<div class="fragment"><div class="line">modded <span class="keyword">class </span><a class="code hl_interface" href="interfacePlayerNameInputController.html">PlayerNameInputController</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code hl_function" href="interfacePlayerNameInputController.html#a37731cc57e18d86a801eb82b521c0a22">OnAuthorityReady</a>()</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;PlayerNameInputController.OnAuthorityReady()&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">bool</span> RplGiven(<a class="code hl_interface" href="interfaceScriptBitReader.html">ScriptBitReader</a> reader)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__Debug.html#ga4080cd5485010d254548bb55ecc5522a">Print</a>(<span class="stringliteral">&quot;PlayerNameInputController.RplGiven()&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="el" href="interfaceWorldController.html#ab9a306cb2c3b687cb6d67a5f74cc9c8e">WorldController.OnAuthorityReady()</a> is part of world controller framework and it is always invoked once authority instance fully prepared. On the other hand, <code>RplGiven()</code> is more general replication callback which is related to ownership transfer in replication, but in this case it can be used as signal that proxy instance on owning client is fully prepared.</p>
<p>You might have been wondering why <a class="el" href="interfacePlayerNameInputController.html" title="[World controller example]">PlayerNameInputController</a> is created both on client and server, even though <a class="el" href="interfacePlayerNameInputSystem.html" title="[Class hierarchy example]">PlayerNameInputSystem</a> has its <code>Location</code> set to <a class="el" href="group__WorldSystems.html#ggade20c4a48889d4b85339ceef081573cea577d7068826de925ea2aec01dbadf5e4">ESystemLocation.Client</a>. This is is because world controllers exist purely to allow client-server communication within replication infrastructure. It makes no sense to have client-only or server-only controller. Therefore, when gathering set of world controllers to create based on world systems in config, all world systems which are created either on client or on server have their controller created as well. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
